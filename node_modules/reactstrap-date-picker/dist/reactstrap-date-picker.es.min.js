import e,{useState as t,useEffect as n,useCallback as a,useRef as r,forwardRef as o,useImperativeHandle as l}from"react";import{InputGroup as c,InputGroupText as s,Input as u,Button as i,Popover as d,PopoverHeader as p,PopoverBody as m}from"reactstrap";import v from"prop-types";var g=t=>{var{children:n,customInputGroup:a,size:r,inputId:o}=t;return null!=a?e.cloneElement(a,{children:n}):e.createElement(c,{size:r,id:o,className:"rdp-input-group"},n)},y=t=>{var{overlayContainerRef:n}=t;return e.createElement("div",{ref:n,className:"rdp-overlay"})},h=t=>{var{inputId:n,name:a,value:r,formattedValue:o,hiddenInputRef:l}=t;return e.createElement("input",{ref:l,type:"hidden",className:"rdp-hidden",id:n,name:a,value:r||"","data-formattedvalue":o})},D=t=>{var{inputValue:n,disabled:a,clearButtonElement:r,onClick:o}=t;return e.createElement("div",{className:"rdp-addon input-group-append"},e.createElement(s,{onClick:()=>a?null:o(),style:{opacity:n&&!a?1:.5,cursor:n&&!a?"pointer":"not-allowed"}},r))};function f(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function w(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?f(Object(n),!0).forEach((function(t){b(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):f(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function b(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var E=t=>{var{customControl:n,controlId:a,value:r,required:o,placeholder:l,inputRef:c,disabled:s,className:i,style:d,autoFocus:p,autoComplete:m,valid:v,invalid:g,onInvalid:y,noValidate:h,onKeyDown:D,onFocus:f,onBlur:b,onChange:E}=t,k="".concat(!0===g?"is-invalid":""," ").concat(!0===v?"is-valid":"");return null!=n?e.cloneElement(n,{id:a,value:r||"",required:o,placeholder:l,ref:c,disabled:s,className:"rdp-form-control ".concat(i||""," ").concat(n.props.className||""," ").concat(k),style:w(w({},n.props.style||{}),d||{}),autoComplete:m,onInvalid:y,noValidate:h,onKeyDown:D,onFocus:f,onBlur:b,onChange:E}):e.createElement(u,{id:a,name:a,value:r||"",required:o,placeholder:l,innerRef:c,disabled:s,type:"text",className:"rdp-form-control ".concat(i||""," ").concat(k),style:d,autoFocus:p,autoComplete:m,onInvalid:y,noValidate:h,onKeyDown:D,onFocus:f,onBlur:b,onChange:E})},k=e=>e?(e.setHours(12-e.getTimezoneOffset()/60),e.setMinutes(0),e.setSeconds(0),e.setMilliseconds(0),e):null,C=e=>e?k(new Date(e)):null,B=e=>e?k(e).toISOString():null,O=(e,t,n)=>{var a=e.getMonth()+1,r=e.getDate();return n.match(/MM.DD.YYYY/)?(a>9?a:"0".concat(a))+t+(r>9?r:"0".concat(r))+t+e.getFullYear():n.match(/DD.MM.YYYY/)?(r>9?r:"0".concat(r))+t+(a>9?a:"0".concat(a))+t+e.getFullYear():e.getFullYear()+t+(a>9?a:"0".concat(a))+t+(r>9?r:"0".concat(r))},P=(e,t)=>null!=e&&""!=e?e:null!=t&&""!=t?t:(()=>{if("object"==typeof window){null==window._reactstrapDatePickerInstance&&(window._reactstrapDatePickerInstance=0);var e=window._reactstrapDatePickerInstance+1;return window._reactstrapDatePickerInstance=e,e}if("object"==typeof process){null==process._reactstrapDatePickerInstance&&(process._reactstrapDatePickerInstance=0);var t=process._reactstrapDatePickerInstance+1;return process._reactstrapDatePickerInstance=t,t}return console.error("Reactstrap Date Picker cannot determine environment (it is neither browser's <window> nor Node's <process>)."),1})().toString(),Y=(e,t,n)=>{var a,r=P(e,t),o="rdp-input-group-".concat(r),l=null!=e?e:"rdp-hidden-".concat(r),c="rdp-form-control-".concat(r);return null!=n&&null!=n&&null!==(a=n.props)&&void 0!==a&&a.id&&(c=n.props.id),[o,l,c]},M=(e,t)=>t>1?e.slice(t).concat(e.slice(0,t)):1===t?e.slice(1).concat(e.slice(0,1)):e,N=(e,t)=>{try{var n=new Date(e),a=new Date(t),r=n.getFullYear()==a.getFullYear();return n.getMonth()==a.getMonth()&&r}catch(e){return console.error(e),!0}};function I(a){var{previousButtonElement:r,nextButtonElement:o,displayDate:l,minDate:c,maxDate:s,onChange:u,monthLabels:i}=a,[d,p]=t(!1),[m,v]=t(!1),[g,y]=t("");n((()=>{if(null!=l){p(!!c&&N(l,c)),v(!!s&&N(l,s));try{y("".concat(i[l.getMonth()]," ").concat(l.getFullYear()))}catch(e){console.error(e)}}}),[l,c,s,i]);var h=e=>{var t=new Date(l);t.setDate(1),t.setMonth(t.getMonth()+e),u(t)};return e.createElement("div",{className:"rdp-header text-center"},e.createElement("div",{className:"text-muted rdp-header-previous-wrapper",onClick:()=>h(-1),style:{cursor:"pointer",float:"left",userSelect:"none"}},d?null:r),e.createElement("span",null,g),e.createElement("div",{className:"text-muted rdp-header-next-wrapper",onClick:()=>h(1),style:{cursor:"pointer",float:"right",userSelect:"none"}},m?null:o))}var x=t=>{var{dayLabels:n,showWeeks:a,cellPadding:r}=t;return e.createElement("thead",null,e.createElement("tr",null,a?e.createElement("td",{className:"text-muted current-week",style:{padding:r}}):null,n.map(((t,n)=>e.createElement("td",{key:n,className:"text-muted",style:{padding:r}},e.createElement("small",null,t))))))},L=()=>e.createElement("td",null),F={normal:"",muted:"text-muted",selected:"bg-primary",current:"text-primary"},j=t=>{var{day:n,mode:a,onDayClick:r,cellPadding:o,roundedCorners:l}=t;return e.createElement("td",{"data-day":n,onClick:e=>{"muted"!=a&&r(e)},style:{cursor:"muted"==a?"default":"pointer",padding:o,borderRadius:l?"5px":"0px"},className:F[a]},n)},S=t=>{var{weekNum:n,cellPadding:a}=t;return e.createElement("td",{style:{padding:a,fontSize:"0.8em",color:"darkgrey"},className:"text-muted"},n)},_=t=>{var{calendarDays:n,showWeeks:a,onDayClick:r,cellPadding:o,roundedCorners:l}=t;return n?e.createElement("tbody",null,n.map(((t,n)=>e.createElement("tr",{key:"rdp_calendar_week_".concat(n)},a?e.createElement(S,{key:"rdp_calendar_week_".concat(n,"_weeknum"),weekNum:t.weekNum,cellPadding:o}):null,t.weekDays.map(((t,a)=>t.inMonth?e.createElement(j,{key:"rdp_calendar_week_".concat(n,"_day_").concat(a),day:t.day,mode:t.mode,onDayClick:r,cellPadding:o,roundedCorners:l}):e.createElement(L,{key:"rdp_calendar_week_".concat(n,"_day_").concat(a)}))))))):e.createElement("tbody",null)},T=t=>{var{dayLabels:n,showWeeks:a,handleTodayClick:r,showTodayButton:o,todayButtonLabel:l}=t;return o?e.createElement("tfoot",null,e.createElement("tr",null,e.createElement("td",{colSpan:n.length+(a?1:0),style:{paddingTop:"9px"}},e.createElement(i,{block:!0,size:"sm",className:"u-today-button",onClick:()=>r()},l)))):null},R=[31,28,31,30,31,30,31,31,30,31,30,31];function V(e,a,r,o,l){var[c,s]=t(void 0),[u,i]=t(void 0),[d,p]=t(void 0),[m,v]=t([]);return n((()=>{e&&(s(e.getFullYear()),i(e.getMonth()))}),[e]),n((()=>{p(function(e,t,n){if(null!=e&&null!=t){var a=new Date(e,t,1),r=n>1?a.getDay()-n+7:1===n?0===a.getDay()?6:a.getDay()-1:a.getDay(),o=R[t];1==t&&(e%4==0&&e%100!=0||e%400==0)&&(o=29);for(var l=(e,t,n)=>e<=o&&(t>0||n>=r),c=n=>{var a=new Date(e,t,n-1,12,0,0,0),r=new Date(a.valueOf()),o=(a.getDay()+6)%7;r.setDate(r.getDate()-o+3);var l=r.valueOf();return r.setMonth(0,1),4!==r.getDay()&&r.setMonth(0,1+(4-r.getDay()+7)%7),1+Math.ceil((l-r)/6048e5)},s=[],u=1,i=0;i<9;i++){for(var d=[],p=0;p<=6;p++)l(u,i,p)?(d.push({inMonth:!0,day:u}),u+=1):d.push({inMonth:!1});var m=c(u);if(s.push({weekDays:d,weekNum:m}),u>o)break}return{year:e,month:t,weeks:s}}}(c,u,l))}),[c,u,l]),n((()=>{v(function(e,t,n,a){if(null==e)return[];var r=[];return e.weeks.map((o=>{var l=o.weekNum,c=o.weekDays.map((r=>{return w(w({},r),{},{mode:r.inMonth?(o=r.day,l=k(new Date(e.year,e.month,o,12,0,0,0)).toISOString(),c=null!=n&&Date.parse(l)<Date.parse(k(new Date(n))),s=null!=a&&Date.parse(l)>Date.parse(k(new Date(a))),u=k(new Date),i=k(new Date(t)),c||s?"muted":Date.parse(l)===Date.parse(i)?"selected":Date.parse(l)===Date.parse(u)?"current":"normal"):void 0});var o,l,c,s,u,i}));r.push({weekNum:l,weekDays:c})})),r}(d,a,r,o))}),[d,a,r,o]),m}var W=t=>{var{selectedDate:n,displayDate:a,minDate:r,maxDate:o,onChange:l,dayLabels:c,cellPadding:s,weekStartsOn:u,showTodayButton:i,todayButtonLabel:v,roundedCorners:g,showWeeks:y,monthLabels:h,previousButtonElement:D,nextButtonElement:f,placement:w,open:b,container:E,target:C,onChangeMonth:B}=t,O=V(a,n,r,o,u);return e.createElement(e.Fragment,null,e.createElement(d,{className:"rdp-popover ".concat(w),isOpen:b,container:E,target:C,placement:w},e.createElement(p,{tag:"div"},e.createElement(I,{previousButtonElement:D,nextButtonElement:f,displayDate:a,minDate:r,maxDate:o,onChange:e=>B(e),monthLabels:h})),e.createElement(m,null,e.createElement("table",{className:"rdp-calendar text-center"},e.createElement(x,{dayLabels:c,showWeeks:y,cellPadding:s}),e.createElement(_,{calendarDays:O,showWeeks:y,onDayClick:e=>{var t=e.currentTarget.getAttribute("data-day"),n=k(new Date(a));n.setDate(t),l(n)},cellPadding:s,roundedCorners:g}),e.createElement(T,{dayLabels:c,showWeeks:y,handleTodayClick:()=>{var e=k(new Date);l(e)},showTodayButton:i,todayButtonLabel:v})))))};W.propTypes={selectedDate:v.object,displayDate:v.object,minDate:v.string,maxDate:v.string,onChange:v.func.isRequired,dayLabels:v.array.isRequired,cellPadding:v.string.isRequired,weekStartsOn:v.number,showTodayButton:v.bool,todayButtonLabel:v.string,roundedCorners:v.bool,showWeeks:v.bool,monthLabels:v.array.isRequired,previousButtonElement:v.oneOfType([v.string,v.object]).isRequired,nextButtonElement:v.oneOfType([v.string,v.object]).isRequired,placement:v.oneOfType([v.string,v.func])};var q,z=e=>{var t=Object.prototype.toString.call(e);return"[object AsyncFunction]"===t||"[object Function]"===t||"[object GeneratorFunction]"===t||"[object Proxy]"===t?e():e},A=(e,o,l,c,s)=>{var[u,i]=t(!1),[d,p]=t(z(e)),m=r(),v=r(),g=o||r(),[y,h]=((e,t,n)=>[a((()=>{if(t){var n=document.createEvent("CustomEvent");n.initEvent("Change Date",!0,!1),e.current.dispatchEvent(n),t(n)}}),[e,t]),a((()=>{if(n){var t=document.createEvent("CustomEvent");t.initEvent("Change Date",!0,!1),e.current.dispatchEvent(t),n(t)}}),[e,n])])(g,c,s);n((()=>{function e(e){e.stopPropagation(),u&&v&&v.current&&!v.current.contains(e.target)&&(i(!1),y())}return document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}}),[u,v,y]);var D=a((()=>{var t=z(e);p(t),i(!0),h()}),[e,h]);return[m,v,g,u,d,D,e=>{u&&!e||(i(!1),y())}]},G=void 0===G?function(){}:G,J=v.oneOfType([v.func,v.shape({current:v.instanceOf(G)})]),K=v.oneOfType([v.string,v.object]),Z={value:v.string,defaultValue:v.string,id:v.string,name:v.string,dateFormat:v.string,minDate:v.string,maxDate:v.string,clearButtonElement:K,showClearButton:v.bool},H={clearButtonElement:"Ã—",dateFormat:(q="undefined"!=typeof window&&window.navigator?(window.navigator.userLanguage||window.navigator.language||"").toLowerCase():"",q&&"en-us"!==q?"DD/MM/YYYY":"MM/DD/YYYY"),showClearButton:!0},Q={onInvalid:v.func,onChange:v.func,onClear:v.func,onBlur:v.func,onFocus:v.func},U={size:v.string,valid:v.bool,invalid:v.bool,customInputGroup:v.object},X={autoComplete:v.string,autoFocus:v.bool,disabled:v.bool,noValidate:v.bool,placeholder:v.string,required:v.bool,className:v.string,style:v.object,inputRef:J,customControl:v.object,children:v.oneOfType([v.arrayOf(v.node),v.node])},$={dayLabels:v.array,monthLabels:v.array,weekStartsOn:v.number,showWeeks:v.bool,previousButtonElement:K,nextButtonElement:K,showTodayButton:v.bool,todayButtonLabel:v.string,roundedCorners:v.bool,cellPadding:v.string,calendarPlacement:v.oneOfType([v.string,v.func]),calendarContainer:v.oneOfType([v.string,J])},ee=w(w(w(w(w({},Z),Q),U),X),$),te=w(w(w({},H),{autoFocus:!1,disabled:!1,autoComplete:"on",noValidate:!1}),{cellPadding:"5px",dayLabels:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],monthLabels:["January","February","March","April","May","June","July","August","September","October","November","December"],previousButtonElement:"<",nextButtonElement:">",calendarPlacement:"bottom",showTodayButton:!1,todayButtonLabel:"Today",showWeeks:!1,roundedCorners:!1});function ne(a,r){var{value:o,defaultValue:c,dateFormat:s,weekStartsOn:u,minDate:i,maxDate:d,onChange:p,onFocus:m,onBlur:v,onClear:f,onInvalid:w,id:b,name:k,required:P,placeholder:N,inputRef:I,noValidate:x,valid:L,invalid:F,customInputGroup:j,style:S,className:_,autoComplete:T,autoFocus:R,disabled:V,size:q,customControl:z,showClearButton:G,clearButtonElement:J,previousButtonElement:K,nextButtonElement:Z,cellPadding:H,roundedCorners:Q,dayLabels:U,monthLabels:X,calendarPlacement:$,calendarContainer:ee,showWeeks:te,showTodayButton:ne,todayButtonLabel:ae,children:re}=a,oe=((e,t)=>{if(e&&t)return"Conflicting DatePicker properties 'value' and 'defaultValue'"})(o,c);if(null!=oe)throw new Error(oe);var[le,ce,se,ue,ie,de,pe]=A($,I,0,v,m),[me,ve,ge,ye,he,De,fe,we]=((e,a,r,o,l,c,s,u)=>{var[i,d]=t(c.match(/[^A-Z]/)[0]),[p,m]=t(null),[v,g]=t(null),[y,h]=t(null),[D,f]=t(null);n((()=>{d(c.match(/[^A-Z]/)[0])}),[c]),n((()=>{var e,t=a||r,n=C(n),o=C(o),l=C(t),s=B(l),u=t?O(l,i,c):null;if(l)e=l;else{var d=C((new Date).toISOString());e=n&&Date.parse(n)>=Date.parse(d)?n:o&&Date.parse(o)<=Date.parse(d)?o:d}m(s),g(u),f(l),h(e)}),[a,r,o,l,i,c]);var w=()=>{s?s():(m(null),g(null),f(null),h(null)),u&&u(null,null)},b=e=>{var t=e.replace(new RegExp("[^0-9".concat(i,"]")),"").split(i);c.match(/MM.DD.YYYY/)||c.match(/DD.MM.YYYY/)?(t[0]&&t[0].length>2&&(t[1]=t[0].slice(2)+(t[1]||""),t[0]=t[0].slice(0,2)),t[1]&&t[1].length>2&&(t[2]=t[1].slice(2)+(t[2]||""),t[1]=t[1].slice(0,2)),t[2]&&(t[2]=t[2].slice(0,4))):(t[0]&&t[0].length>4&&(t[1]=t[0].slice(4)+(t[1]||""),t[0]=t[0].slice(0,4)),t[1]&&t[1].length>2&&(t[2]=t[1].slice(2)+(t[2]||""),t[1]=t[1].slice(0,2)),t[2]&&(t[2]=t[2].slice(0,2)));var n=t.join(i);g(n)};return[p,v,y,D,w,()=>{var t=e.current.value,n=t.replace(/(-|\/\/)/g,i).slice(0,10);if(n){var a,r,s;if(c.match(/MM.DD.YYYY/)){if(!n.match(/[0-1][0-9].[0-3][0-9].[1-2][0-9][0-9][0-9]/))return b(t);a=n.slice(0,2).replace(/[^0-9]/g,""),r=n.slice(3,5).replace(/[^0-9]/g,""),s=n.slice(6,10).replace(/[^0-9]/g,"")}else if(c.match(/DD.MM.YYYY/)){if(!n.match(/[0-3][0-9].[0-1][0-9].[1-2][0-9][0-9][0-9]/))return b(t);r=n.slice(0,2).replace(/[^0-9]/g,""),a=n.slice(3,5).replace(/[^0-9]/g,""),s=n.slice(6,10).replace(/[^0-9]/g,"")}else{if(!n.match(/[1-2][0-9][0-9][0-9].[0-1][0-9].[0-3][0-9]/))return b(t);s=n.slice(0,4).replace(/[^0-9]/g,""),a=n.slice(5,7).replace(/[^0-9]/g,""),r=n.slice(8,10).replace(/[^0-9]/g,"")}var d=parseInt(a,10),p=parseInt(r,10),v=parseInt(s,10);if(d>12||p>31)return b(t);var y=o&&Date.parse(t)<Date.parse(o),D=l&&Date.parse(t)>Date.parse(l);if(y||D)return b(t);if(!isNaN(d)&&!isNaN(p)&&!isNaN(v)&&d<=12&&p<=31&&v>999){var E=C(new Date(v,d-1,p,12,0,0,0).toISOString()),k=B(E);f(E),h(E),m(k),u&&u(k,n)}g(n)}else w()},e=>{h(e)},e=>{var t=B(e),n=O(e,i,c);g(n),f(e),h(e),m(t),u&&u(t,n)}]})(se,o,c,i,d,s,f,p),[be,Ee,ke]=((e,a,r)=>{var[o,l]=t(Y(e,a,r));return n((()=>{l(Y(e,a,r))}),[e,a,r]),o})(b,k,z);l(r,(()=>({getValue:()=>ye?ye.toISOString():null,getFormattedValue:()=>ge?ve:null,getNode:()=>null==se?void 0:se.current})));var Ce=((e,a)=>{var[r,o]=t(M(e,a));return n((()=>{o(M(e,a))}),[e,a]),r})(U,u);return e.createElement(g,{customInputGroup:j,size:q,inputId:be},e.createElement(E,{controlId:ke,customControl:z,value:ve||"",required:P,placeholder:N||"",inputRef:se,disabled:V,className:_,style:S,autoFocus:R,autoComplete:T,onInvalid:w,noValidate:x,valid:L,invalid:F,onFocus:()=>de(),onBlur:e=>{var t;return pe((null==e||null===(t=e.data)||void 0===t?void 0:t.rdp_close_calendar)||!1)},onChange:()=>De()}),e.createElement(W,{placement:ie,open:ue,container:ee||ce.current,target:ke,previousButtonElement:K,nextButtonElement:Z,displayDate:ge,minDate:i,maxDate:d,onChangeMonth:e=>fe(e),monthLabels:X,cellPadding:H,selectedDate:ye,onChange:e=>(we(e),void pe(!0)),dayLabels:Ce,weekStartsOn:u,showTodayButton:ne,todayButtonLabel:ae,roundedCorners:Q,showWeeks:te}),e.createElement(y,{overlayContainerRef:ce}),e.createElement(h,{inputId:Ee,name:k,value:me||"",formattedValue:me?ve:"",hiddenInputRef:le}),G&&!z?e.createElement(D,{inputValue:ve,disabled:V,clearButtonElement:J,onClick:()=>he()}):null,re)}var ae=o(ne);ae.propTypes=ee,ae.defaultProps=te;export{ae as DatePicker};
